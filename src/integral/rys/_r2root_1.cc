//
// BAGEL - Parallel electron correlation program.
// Filename: _r2root_1.cc
// Copyright (C) 2013 Toru Shiozaki
//
// Author: Toru Shiozaki <shiozaki@northwestern.edu>
// Maintainer: Shiozaki group
//
// This file is part of the BAGEL package.
//
// The BAGEL package is free software; you can redistribute it and/or modify
// it under the terms of the GNU Library General Public License as published by
// the Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// The BAGEL package is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Library General Public License for more details.
//
// You should have received a copy of the GNU Library General Public License
// along with the BAGEL package; see COPYING.  If not, write to
// the Free Software Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.
//

#include <algorithm>
#include <src/integral/rys/r2rootlist.h>

using namespace std;
using namespace bagel;

void R2RootList::r2root1(const double* ta, double* rr, double* ww, const int n) {

  constexpr double x[396] = {  8.615672004782865e-01,  9.950266140631300e-02,  1.533912849818139e-03, -5.409850309586831e-04, -1.877246401351007e-05,
  3.964916382485603e-06,  2.069710271328521e-07, -2.932418810913451e-08, -2.106101188554058e-09,  2.104829382795059e-10,  2.024247003558271e-11, -1.450167874470594e-12,
  1.244049918873936e+00,  8.692405629975766e-02, -4.119616468424005e-03, -2.428182428139501e-04,  4.052454820413477e-05, -2.365367018816754e-07, -2.939755999823473e-07,
  1.600261460738115e-08,  1.478838484787080e-09, -1.931394874416050e-10, -2.109349871930735e-12,  1.588439313333967e-12,  1.520420312449508e+00,  5.137973194761360e-02,
 -4.049376396721139e-03,  1.628573631740609e-04,  6.781166705591642e-06, -1.530730470030324e-06,  9.187187835212407e-08,  1.244819557206547e-09, -6.459780778741882e-10,
  4.659877273155007e-11, -8.503201014375361e-14, -2.658861520205036e-13,  1.673983093884788e+00,  2.704696585869289e-02, -2.097241214004720e-03,  1.331242955577535e-04,
 -5.534488526369556e-06, -4.646575658548384e-09,  2.400260672639802e-08, -2.249108425896889e-09,  1.080392014705135e-10, -5.433587247427636e-13, -3.993358516273704e-13,
  3.871128467611116e-14,  1.756755295964857e+00,  1.526939401059622e-02, -9.760889217727449e-04,  5.991237875908007e-05, -3.236265630708331e-06,  1.351713237130889e-07,
 -2.809293182807990e-09, -1.585774657376541e-10,  2.290906724458756e-11, -1.559354063446335e-12,  6.917248987963722e-14, -1.482748602858406e-15,  1.805762908789837e+00,
  9.634620173892362e-03, -4.921365250701888e-04,  2.557226571939016e-05, -1.300497736527902e-06,  6.101584375195805e-08, -2.437061621709970e-09,  7.013552343527356e-11,
 -3.488709732134984e-13, -1.286697251138654e-13,  1.120698050563011e-14, -6.192351833637347e-16,  1.837971363922831e+00,  6.646460734388877e-03, -2.784452228285442e-04,
  1.196120816031866e-05, -5.227190840898300e-07,  2.264746718662345e-08, -9.335389284735220e-10,  3.468544844880834e-11, -1.066769383557168e-12,  2.116826116756438e-14,
  2.345908610911457e-16, -5.222456556248651e-17,  1.860847534113921e+00,  4.878761611522788e-03, -1.733327430494812e-04,  6.273808634293244e-06, -2.321069795104612e-07,
  8.735947162910782e-09, -3.287693689809054e-10,  1.201478574205405e-11, -4.102661823530534e-13,  1.242329332697658e-14, -3.016824142320855e-16,  3.916841967140864e-18,
  1.877991517488670e+00,  3.741078240802150e-03, -1.156939901111019e-04,  3.621371786842781e-06, -1.152299680894067e-07,  3.738215035907146e-09, -1.233389970475859e-10,
  4.091558731011531e-12, -1.336358653188913e-13,  4.176947870763947e-15, -1.205137580327364e-16,  3.038953175999736e-18,  1.891342077656611e+00,  2.962810156580051e-03,
 -8.126455540200233e-05,  2.246728841615451e-06, -6.279795101563453e-08,  1.780912313065383e-09, -5.138321084150803e-11,  1.506868761572180e-12, -4.458313219859004e-14,
  1.310993670760591e-15, -3.750547199370709e-17,  1.015883245606674e-18,  1.902042817738832e+00,  2.405788434778285e-03, -5.934079650257259e-05,  1.471820590088685e-06,
 -3.677393684188755e-08,  9.278933628226153e-10, -2.371581684682288e-11,  6.155396758059423e-13, -1.622501974064670e-14,  4.323312946430393e-16, -1.152275862310228e-17,
  3.021040088659656e-19,  1.910815893332901e+00,  1.992941780260402e-03, -4.468319556078193e-05,  1.005936878118705e-06, -2.276381680167527e-08,  5.186082766346359e-10,
 -1.191996498974794e-11,  2.771180635960570e-13, -6.531636287848285e-15,  1.561922665212264e-16, -3.779421933054024e-18,  9.181196966451886e-20,  1.918141365457714e+00,
  1.678268301897362e-03, -3.449903529981664e-05,  7.114203879458371e-07, -1.472721058138515e-08,  3.063409501934141e-10, -6.411504411656753e-12,  1.352595342523048e-13,
 -2.882582404178766e-15,  6.219130506393346e-17, -1.359852469160702e-18,  3.008115514656167e-20,  1.924351419269268e+00,  1.432835430103866e-03, -2.719758185809975e-05,
  5.175623659526523e-07, -9.878661992941264e-09,  1.892371183315265e-10, -3.641270036396126e-12,  7.045933020294778e-14, -1.373191044537761e-15,  2.700532536716890e-17,
 -5.369532546189544e-19,  1.080387132270498e-20,  1.929683485055911e+00,  1.237670567655355e-03, -2.182402902982178e-05,  3.856251468406781e-07, -6.830347280835652e-09,
  1.213256466579220e-10, -2.162399124984232e-12,  3.870025681094534e-14, -6.961767400293297e-16,  1.260447001787078e-17, -2.300568790657252e-19,  4.238942468689443e-21,
  1.934311889610483e+00,  1.079898245253338e-03, -1.778039142701763e-05,  2.932598716763900e-07, -4.846474253439076e-09,  8.027770377019039e-11, -1.333298305458209e-12,
  2.221458339960047e-14, -3.715437572299759e-16,  6.243351805233149e-18, -1.055243727034588e-19,  1.795955182916827e-21,  1.938367570853606e+00,  9.505250333095805e-04,
 -1.467865812419493e-05,  2.270118080791165e-07, -3.516686220088063e-09,  5.458109471166947e-11, -8.489779215928949e-13,  1.323876448377117e-14, -2.070557810748222e-16,
  3.249860396672724e-18, -5.122774427508596e-20,  8.115603549956132e-22,  1.941950815969983e+00,  8.431121426034387e-04, -1.225936615946490e-05,  1.784845574279263e-07,
 -2.602250684545457e-09,  3.800064819616982e-11, -5.559279514106613e-13,  8.149724982277553e-15, -1.197570342835905e-16,  1.764672462932977e-18, -2.608863048588009e-20,
  3.871231407221051e-22,  1.945139750899207e+00,  7.529500670201870e-04, -1.034444060283336e-05,  1.422742016518369e-07, -1.959189583309629e-09,  2.701588654139113e-11,
 -3.731007628742734e-13,  5.161571431921124e-15, -7.154645316647018e-17,  9.939582286449136e-19, -1.384443249344490e-20,  1.933824234548166e-22,  1.947996151062827e+00,
  6.765289339651707e-04, -8.808853963377106e-06,  1.148080593225617e-07, -1.497919050035266e-09,  1.956665977988618e-11, -2.559260001018839e-13,  3.352337778254605e-15,
 -4.398399006477316e-17,  5.781592874390668e-19, -7.615844455382418e-21,  1.005465158942304e-22,  1.950569512007504e+00,  6.111891758621598e-04, -7.563043704663643e-06,
  9.366757264477257e-08, -1.161152375320471e-09,  1.440910031513772e-11, -1.790104293211819e-13,  2.226725006809410e-15, -2.773721784654558e-17,  3.460499586318273e-19,
 -4.324926575950356e-21,  5.415208946203335e-23,  1.952899959950286e+00,  5.548855199156916e-04, -6.541695717417760e-06,  7.718069158659645e-08, -9.113561700003159e-10,
  1.077115479510630e-11, -1.274291970815919e-13,  1.509215447294617e-15, -1.789609933458599e-17,  2.124941764669424e-19, -2.526870355654348e-21,  3.009409934088734e-23,
  1.955020370977423e+00,  5.060240979673037e-04, -5.696410269785779e-06,  6.416949759200000e-08, -7.233999767699963e-10,  8.161668098889824e-12, -9.216403853603279e-14,
  1.041745712959059e-15, -1.178744885814943e-17,  1.335308354312672e-19, -1.514604972541009e-21,  1.720194256532188e-23,  1.956957939330155e+00,  4.633478581299383e-04,
 -4.990799928148092e-06,  5.378998657957680e-08, -5.801261525846958e-10,  6.261191879127812e-12, -6.762880126009319e-14,  7.310989386852191e-16, -7.910860409705229e-18,
  8.568641199925554e-20, -9.291448636268735e-22,  1.008637920112126e-23,  1.958735355099840e+00,  4.258545603915292e-04, -4.397147623931367e-06,  4.542805043930137e-08,
 -4.696117072989436e-10,  4.857757949175649e-12, -5.028489310632612e-14,  5.209175129720071e-16, -5.400799869507380e-18,  5.604490734207370e-20, -5.821545116667268e-22,
  6.052808408504760e-24,  1.960371700407081e+00,  3.927371724872791e-04, -3.894087272300851e-06,  3.863056306775256e-08, -3.834370471210147e-10,  3.808135088677736e-12,
 -3.784471238029698e-14,  3.763518241594083e-16, -3.745436667123725e-18,  3.730411978146016e-20, -3.718658974694634e-22,  3.710056953108370e-24,  1.961883139631836e+00,
  3.633399310548020e-04, -3.464967723059611e-06,  3.305887657220832e-08, -3.155685893102470e-10,  3.013918318259026e-12, -2.880168776268112e-14,  2.754048060618046e-16,
 -2.635193064753267e-18,  2.523266104057687e-20, -2.417954411833371e-22,  2.318756090116458e-24,  1.963283456916372e+00,  3.371255301933471e-04, -3.096681487661763e-06,
  2.845690922283357e-08, -2.616239227394248e-10,  2.406462186708588e-12, -2.214659900739957e-14,  2.039282362546751e-16, -1.878916331027582e-18,  1.732273390174898e-20,
 -1.598179082218861e-22,  1.475437011379743e-24,  1.964584478992249e+00,  3.136503275906950e-04, -2.778814730158071e-06,  2.462890737578862e-08, -2.183801726113038e-10,
  1.937204593472365e-12, -1.719272593983444e-14,  1.526633644108558e-16, -1.356316033543170e-18,  1.205700651193316e-20, -1.072478936230313e-22,  9.545401129945845e-25,
  1.965796410912972e+00,  2.925454036648383e-04, -2.503022635940579e-06,  2.142372801402003e-08, -1.834398409894393e-10,  1.571342994966564e-12, -1.346598889479031e-14,
  1.154536355775585e-16, -9.903582151689067e-19,  8.499761616670204e-21, -7.299055129127475e-23,  6.271292713638548e-25,  1.966928104939505e+00,  2.735019454498620e-04,
 -2.262565062863636e-06,  1.872358391090007e-08, -1.550003468978782e-10,  1.283634394979754e-12, -1.063469262801621e-14,  8.814429358227815e-17, -7.309047030875973e-19,
  6.063693287932565e-21, -5.033120425397562e-23,  4.179708300398994e-25,  1.967987277616313e+00,  2.562598618889917e-04, -2.051957627757253e-06,  1.643588626194427e-08,
 -1.316929250646179e-10,  1.055563953559998e-12, -8.463856423178979e-15,  6.789271564580435e-17, -5.448281176399980e-19,  4.374096911557644e-21, -3.513353754092995e-23,
  2.823221281122484e-25,  1.988212225264385e+00, -7.867853219775265e-03, -1.981053183687279e-03, -8.181732340632134e-06, -1.124357725103084e-06, -3.334682195387856e-08,
 -3.562899129425637e-09, -1.907956760751846e-10, -1.890673195679909e-11, -1.423883315765716e-12, -1.440132426345546e-13, -1.328779004072589e-14  };
  constexpr double w[396] = {  1.196288013322608e+00, -3.316232965592209e-01,  6.095273008599551e-02, -8.299712742284355e-03,  8.942329876147542e-04,
 -7.957392659079802e-05,  6.025721136803708e-06, -3.969201067849495e-07,  2.312804303434212e-08, -1.207969269035796e-09,  5.715934179077561e-11, -2.468396282128691e-12,
  4.452346579238068e-01, -8.311524084419178e-02,  1.255931437636079e-02, -1.533468636928158e-03,  1.545039956678314e-04, -1.314963796895761e-05,  9.649744437714886e-07,
 -6.210782928571568e-08,  3.555342099219166e-09, -1.831184057722567e-10,  8.567810109678186e-12, -3.665902120277015e-13,  2.377429903237309e-01, -2.824427177117255e-02,
  3.195705818658540e-03, -3.267543641938433e-04,  2.946186579858300e-05, -2.331940320786322e-06,  1.628315706304292e-07, -1.011452876816492e-08,  5.639514172414069e-10,
 -2.846674324404023e-11,  1.310979360108809e-12, -5.538470968528684e-14,  1.589970796066651e-01, -1.287665894780264e-02,  1.056196028365156e-03, -8.507169831618671e-05,
  6.500367314683515e-06, -4.596386271478519e-07,  2.969610552777743e-08, -1.746195748464727e-09,  9.356040228991341e-11, -4.584194647047497e-12,  2.063509467676262e-13,
 -8.563095021989643e-15,  1.197385315696911e-01, -7.252709270101017e-03,  4.473192444486818e-04, -2.793183633680399e-05,  1.736370253306386e-06, -1.050449425354950e-07,
  6.056987521100858e-09, -3.280665683725062e-10,  1.655717667835332e-11, -7.761412737037370e-13,  3.378940492735505e-14, -1.366628530168849e-15,  9.626810003103103e-02,
 -4.662996063966890e-03,  2.285705503681142e-04, -1.136262179042817e-05,  5.714346901143889e-07, -2.880071604122835e-08,  1.433214365694269e-09, -6.928397498597190e-11,
  3.209072014002916e-12, -1.410417061530682e-13,  5.848668087084765e-15, -2.279340431620093e-16,  8.058351310955886e-02, -3.258637916446532e-03,  1.327174540425958e-04,
 -5.457056556711327e-06,  2.269407303202763e-07, -9.537849115198323e-09,  4.030126978263087e-10, -1.695592061691694e-11,  7.017477665482886e-13, -2.822996206092645e-14,
  1.093074789203443e-15, -4.040757643188154e-17,  6.932924008954373e-02, -2.408842598339621e-03,  8.407393338175979e-05, -2.951924168807073e-06,  1.044543675688692e-07,
 -3.730817386393375e-09,  1.345175409278384e-10, -4.882816816215734e-12,  1.773466383350940e-13, -6.388881956677985e-15,  2.260643546208645e-16, -7.777483373816629e-18,
  6.084854101958462e-02, -1.854254921468125e-03,  5.668017559358571e-05, -1.739339240190074e-06,  5.364395714930260e-08, -1.665160088791725e-09,  5.209262279241638e-11,
 -1.643283474186759e-12,  5.220593875585953e-14, -1.664097414252736e-15,  5.289649024259755e-17, -1.662420944827404e-18,  5.422395185914226e-02, -1.471866322910008e-03,
  4.004308606149555e-05, -1.092369674757146e-06,  2.990044623454687e-08, -8.219435998759474e-10,  2.271712264614489e-11, -6.319977485879579e-13,  1.771098221805933e-14,
 -4.997623669105767e-16,  1.416926816996274e-17, -4.016632699871523e-19,  4.890420128298761e-02, -1.196905181662709e-03,  2.934450313381033e-05, -7.208950817610458e-07,
  1.775267101755030e-08, -4.384630207272662e-10,  1.086909999114302e-11, -2.706711575406739e-13,  6.778109957985780e-15, -1.708171820364796e-16,  4.332642031123617e-18,
 -1.104103235705355e-19,  4.453734519471939e-02, -9.925089982409730e-04,  2.214842667432384e-05, -4.950315948637240e-07,  1.108437671661269e-08, -2.487247930122823e-10,
  5.595601387812957e-12, -1.262842492247041e-13,  2.861209771918568e-15, -6.513495672770379e-17,  1.490983203924501e-18, -3.431224548441251e-20,  4.088787282179687e-02,
 -8.364041048434408e-04,  1.712873497073616e-05, -3.512211720294877e-07,  7.211983059600051e-09, -1.483333609811154e-10,  3.056695610867962e-12, -6.313246622911625e-14,
  1.307523266529219e-15, -2.717114370594570e-17,  5.669410844132299e-19, -1.188098535847096e-20,  3.779212484611644e-02, -7.144734267524560e-04,  1.351998281198371e-05,
 -2.561030249256272e-07,  4.856836279125446e-09, -9.222643945721752e-11,  1.753878212714877e-12, -3.341076833168620e-14,  6.377471458811955e-16, -1.220276492624074e-17,
  2.341721548867187e-19, -4.507941553998703e-21,  3.513278421096276e-02, -6.174122022457515e-04,  1.085876232873705e-05, -1.911440307057374e-07,  3.367866315000303e-09,
 -5.940297912184485e-11,  1.049001231055433e-12, -1.854924666364621e-14,  3.285074543419685e-16, -5.828326505040744e-18,  1.036253137433486e-19, -1.846522448925671e-21,
  3.282353309008644e-02, -5.388831606001758e-04,  8.853138180001898e-06, -1.455521963355568e-07,  2.394906608880543e-09, -3.944036416167677e-11,  6.501538000556810e-13,
 -1.072908065467480e-14,  1.772716446194044e-16, -2.933055531212374e-18,  4.860707530205949e-20, -8.068202765847351e-22,  3.079943566852298e-02, -4.744480514700473e-04,
  7.312884660481296e-06, -1.127880866984822e-07,  1.740745387067339e-09, -2.688631126767708e-11,  4.156059104132447e-13, -6.430171359477650e-15,  9.958554583893800e-17,
 -1.544025880391745e-18,  2.396961279335339e-20, -3.725548457844600e-22,  2.901069638231954e-02, -4.209229454878210e-04,  6.110396750143155e-06, -8.875135534067295e-08,
  1.289845833267388e-09, -1.875766283776119e-11,  2.729741785762541e-13, -3.975518135189013e-15,  5.794649049380518e-17, -8.453944909166301e-19,  1.234626846441018e-20,
 -1.804754212546317e-22,  2.741848625675217e-02, -3.759753712315172e-04,  5.157883611450377e-06, -7.079349637826475e-08,  9.721647566563600e-10, -1.335758295891200e-11,
  1.836438261139916e-13, -2.526426935579217e-15,  3.478113464622101e-17, -4.791989337882007e-19,  6.607792826541135e-21, -9.118475490495710e-23,  2.599207897097340e-02,
 -3.378648199254101e-04,  4.393588495831997e-06, -5.715857851144823e-08,  7.439460960932435e-10, -9.687534699519916e-12,  1.262153489176770e-13, -1.645339056943100e-15,
  2.146161800297443e-17, -2.801273655803591e-19,  3.658981134950614e-21, -4.782243816676315e-23,  2.470684057516748e-02, -3.052710986265194e-04,  3.773204060308088e-06,
 -4.665523929846948e-08,  5.771203657811355e-10, -7.141996271054396e-12,  8.842451642015945e-14, -1.095316585130623e-15,  1.357488758214790e-17, -1.683372077920686e-19,
  2.088773528041422e-21, -2.593139222711246e-23,  2.354278983364037e-02, -2.771780960079550e-04,  3.264378020167619e-06, -3.845833802433570e-08,  4.532500071169458e-10,
 -5.343821150151194e-12,  6.302941851061969e-14, -7.437441778768584e-16,  8.780224540779231e-18, -1.037059766610395e-19,  1.225558830070594e-21, -1.448952418741844e-23,
  2.248354863560798e-02, -2.527934096691316e-04,  2.843111217496789e-06, -3.198570925690124e-08,  3.599644185586920e-10, -4.052403680512713e-12,  4.563774828297725e-14,
 -5.141665271806971e-16,  5.795116414395055e-18, -6.534481411738903e-20,  7.371635007661135e-22, -8.319161317514538e-24,  2.151556442695878e-02, -2.314917195235752e-04,
  2.491344954107831e-06, -2.681969535404320e-08,  2.888030380316357e-10, -3.110889072687120e-12,  3.352043619112596e-14, -3.613144807012200e-16,  3.896015028524903e-18,
 -4.202670051941884e-20,  4.535344284225121e-22, -4.895949151334275e-24,  2.062752577549270e-02, -2.127742115140335e-04,  2.195313279940476e-06, -2.265608135500603e-08,
  2.338780009531827e-10, -2.414994743634802e-12,  2.494432127769594e-14, -2.577287554620087e-16,  2.663773937483245e-18, -2.754123946381736e-20,  2.848592599085516e-22,
 -2.947144558781796e-24,  1.980991730138132e-02, -1.962390533430093e-04,  1.944397749045979e-06, -1.927019639452002e-08,  1.910263747709838e-10, -1.894139033776984e-12,
  1.878656032260042e-14, -1.863827035819637e-16,  1.849666309460905e-18, -1.836190342299444e-20,  1.823418127418580e-22, -1.811192649227247e-24,  1.905467666564203e-02,
 -1.815596098814495e-04,  1.730318572315303e-06, -1.649400035726463e-08,  1.572617988954484e-10, -1.499761841061657e-12,  1.430632305960189e-14, -1.365040834516150e-16,
  1.302809081919259e-18, -1.243768409439891e-20,  1.187759410109121e-22, -1.134527881679443e-24,  1.835492730745393e-02, -1.684681626705793e-04,  1.546554930153583e-06,
 -1.420033778225714e-08,  1.304131916577586e-10, -1.197947705377551e-12,  1.100656819588901e-14, -1.011505583131630e-16,  9.298048818197404e-19, -8.549246048145370e-21,
  7.862885631250444e-23, -7.233086030271359e-25,  1.770476809987225e-02, -1.567435992347740e-04,  1.387923896370533e-06, -1.229195168806714e-08,  1.088826482243708e-10,
 -9.646786056623993e-13,  8.548629578107328e-15, -7.577121120890843e-17,  6.717537847704615e-19, -5.956878939909688e-21,  5.283663226632977e-23, -4.687381572950711e-25,
  1.709910626173358e-02, -1.462020029641691e-04,  1.250270760852730e-06, -1.069371052269060e-08,  9.148066106029858e-11, -7.827260651988051e-13,  6.698433347404700e-15,
 -5.733544084409514e-17,  4.908664090940751e-19, -4.203371214687270e-21,  3.600234367557348e-23, -3.084147532402627e-25,  1.653352348837056e-02, -1.366893878232614e-04,
  1.130238654765401e-06, -9.347036956689504e-09,  7.731234114611589e-11, -6.395839024263134e-13,  5.292038621297697e-15, -4.379539001384912e-17,  3.625075364902574e-19,
 -3.001183071328613e-21,  2.485183961029660e-23, -2.058208951633333e-25,  1.600416784101971e-02, -1.280760367140562e-04,  1.025095339136016e-06, -8.205866667668458e-09,
  6.569779896950664e-11, -5.260727848395449e-13,  4.213200569210583e-15, -3.374834727194242e-17,  2.703771131874956e-19, -2.166544140037517e-21,  1.736395746043693e-23,
 -1.391839340183238e-25,  5.893422107119990e-03,  3.933526643758883e-03,  9.902741391231060e-04,  3.976302880239326e-06,  5.262880650030818e-07,  9.437185755241418e-09,
  9.353091583376074e-10,  3.521024802893059e-11,  3.147937069070523e-12,  1.856346021295142e-13,  1.675733945277350e-14,  1.302213977638053e-15  };
  int offset = -1;
  for (int i = 1; i <= n; ++i) {
    double t = ta[i-1];
    offset += 1;
    if (t < 0.0) {
      fill_n(rr+offset, 1, 0.5);
      fill_n(ww+offset, 1, 0.0);
    } else {
      int it;
      if (t >= 64.0) {
        t =    1.000000000000000 / (t * t) ;
        it = static_cast<int>(64*   0.500000000000000 +    1.000000000000000);
      } else {
        it = static_cast<int>(t*   0.500000000000000);
      }
      t = (t-it*2.000000000000000-   1.000000000000000) *   1.000000000000000;
      const double t2 = t * 2.0;
      for (int j=1; j <=1; ++j) {
        const int boxof = it*12+12*(j-1);
            double d = x[boxof+11];
            double e = w[boxof+11];
            double f = t2*d + x[boxof+10];
            double g = t2*e + w[boxof+10];
            d = t2*f - d + x[boxof+9];
            e = t2*g - e + w[boxof+9];
            f = t2*d - f + x[boxof+8];
            g = t2*e - g + w[boxof+8];
            d = t2*f - d + x[boxof+7];
            e = t2*g - e + w[boxof+7];
            f = t2*d - f + x[boxof+6];
            g = t2*e - g + w[boxof+6];
            d = t2*f - d + x[boxof+5];
            e = t2*g - e + w[boxof+5];
            f = t2*d - f + x[boxof+4];
            g = t2*e - g + w[boxof+4];
            d = t2*f - d + x[boxof+3];
            e = t2*g - e + w[boxof+3];
            f = t2*d - f + x[boxof+2];
            g = t2*e - g + w[boxof+2];
            d = t2*f - d + x[boxof+1];
            e = t2*g - e + w[boxof+1];
            rr[offset+j-1] = t*d - f + x[boxof+0]*0.5;
            ww[offset+j-1] = t*e - g + w[boxof+0]*0.5;
      }
    }
  }
}
